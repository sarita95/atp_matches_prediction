# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'dataProcessingDialog.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
from PyQt5 import QtCore, QtGui, QtWidgets
import tennis_image
from featureEngineeringDialog import FeatureEngineeringDialog
from pre_processing.data_pre_processing import DataProcessing
from warningDialog import WarningDialog

absolute_path_to_data = "C:\\Users\\Sara\\PycharmProjects\\tennis_atp"


class DataProcessingDialog(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(516, 395)
        font = QtGui.QFont()
        font.setFamily("Segoe UI Semibold")
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        MainWindow.setFont(font)
        MainWindow.setAutoFillBackground(False)
        MainWindow.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.lineEditFrom = QtWidgets.QLineEdit(self.centralwidget)
        self.lineEditFrom.setGeometry(QtCore.QRect(130, 140, 91, 22))
        self.lineEditFrom.setAutoFillBackground(False)
        self.lineEditFrom.setStyleSheet("background-color: rgb(207, 211, 211);\n"
                                        "color: rgb(0, 0, 0);\n"
                                        "border-style:outset;\n"
                                        "border-radius:10px;\n"
                                        "font: 75 10pt \"MS Shell Dlg 2\";")
        self.lineEditFrom.setText("")
        self.lineEditFrom.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEditFrom.setObjectName("lineEditFrom")
        self.labelTournament = QtWidgets.QLabel(self.centralwidget)
        self.labelTournament.setGeometry(QtCore.QRect(50, 170, 191, 21))
        self.labelTournament.setStyleSheet("font: 10pt \"MS Shell Dlg 2\";\n"
                                           "color: rgb(33, 33, 33);")
        self.labelTournament.setObjectName("labelTournament")
        self.comboBox = QtWidgets.QComboBox(self.centralwidget)
        self.comboBox.setGeometry(QtCore.QRect(90, 200, 161, 22))
        self.comboBox.setStyleSheet("background-color: rgb(207, 211, 211);\n"
                                    "color: rgb(0, 0, 0);\n"
                                    "border : 1px black;\n"
                                    "border-radius:10px;\n"
                                    "font: 75 10pt \"MS Shell Dlg 2\";")
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.comboBox.addItem("")
        self.labelTitle = QtWidgets.QLabel(self.centralwidget)
        self.labelTitle.setGeometry(QtCore.QRect(0, 30, 241, 31))
        self.labelTitle.setFocusPolicy(QtCore.Qt.WheelFocus)
        self.labelTitle.setStyleSheet("font: 20pt \'.SF NS Text\';\n"
                                      "color: rgb(80, 80, 80);")
        self.labelTitle.setAlignment(QtCore.Qt.AlignCenter)
        self.labelTitle.setObjectName("labelTitle")
        self.labelImageAtp = QtWidgets.QLabel(self.centralwidget)
        self.labelImageAtp.setGeometry(QtCore.QRect(340, 260, 171, 131))
        self.labelImageAtp.setStyleSheet("background-image: url(:/tennis/1_WSaVCrl8q_68istViASidQ.jpeg);")
        self.labelImageAtp.setText("")
        self.labelImageAtp.setPixmap(QtGui.QPixmap(":/tennis/1_WSaVCrl8q_68istViASidQ.jpeg"))
        self.labelImageAtp.setScaledContents(True)
        self.labelImageAtp.setObjectName("labelImageAtp")
        self.labelImageData = QtWidgets.QLabel(self.centralwidget)
        self.labelImageData.setGeometry(QtCore.QRect(220, 10, 91, 71))
        self.labelImageData.setStyleSheet("background-image: url(:/tennis/data-processing.jpg);")
        self.labelImageData.setText("")
        self.labelImageData.setPixmap(QtGui.QPixmap(":/tennis/data-processing-icon-line-vector.jpg"))
        self.labelImageData.setScaledContents(True)
        self.labelImageData.setWordWrap(False)
        self.labelImageData.setIndent(8)
        self.labelImageData.setObjectName("labelImageData")
        self.labelYear = QtWidgets.QLabel(self.centralwidget)
        self.labelYear.setGeometry(QtCore.QRect(50, 110, 411, 20))
        self.labelYear.setStyleSheet("font: 10pt \"MS Shell Dlg 2\";\n"
                                     "color: rgb(33, 33, 33);")
        self.labelYear.setObjectName("labelYear")
        self.labelFrom = QtWidgets.QLabel(self.centralwidget)
        self.labelFrom.setGeometry(QtCore.QRect(90, 140, 31, 21))
        self.labelFrom.setStyleSheet("font: 75 9pt \"MS Shell Dlg 2\";\n"
                                     "color: rgb(33, 33, 33);")
        self.labelFrom.setAlignment(QtCore.Qt.AlignCenter)
        self.labelFrom.setObjectName("labelFrom")
        self.labelTo = QtWidgets.QLabel(self.centralwidget)
        self.labelTo.setGeometry(QtCore.QRect(230, 140, 31, 21))
        self.labelTo.setStyleSheet("font: 75 9pt \"MS Shell Dlg 2\";\n"
                                   "color: rgb(33, 33, 33);")
        self.labelTo.setAlignment(QtCore.Qt.AlignCenter)
        self.labelTo.setObjectName("labelTo")
        self.lineEditTo = QtWidgets.QLineEdit(self.centralwidget)
        self.lineEditTo.setGeometry(QtCore.QRect(260, 140, 91, 22))
        self.lineEditTo.setAutoFillBackground(False)
        self.lineEditTo.setStyleSheet("background-color: rgb(207, 211, 211);\n"
                                      "color: rgb(0, 0, 0);\n"
                                      "border-style:outset;\n"
                                      "border-radius:10px;\n"
                                      "font: 75 10pt \"MS Shell Dlg 2\";")
        self.lineEditTo.setText("")
        self.lineEditTo.setAlignment(QtCore.Qt.AlignCenter)
        self.lineEditTo.setObjectName("lineEditTo")
        self.pushButton = QtWidgets.QPushButton(self.centralwidget)
        self.pushButton.setGeometry(QtCore.QRect(130, 270, 141, 31))
        self.pushButton.setStyleSheet("color: rgb(250, 255, 255);\n"
                                      "background-color: rgb(70, 187, 241);\n"
                                      "border-style:outset;\n"
                                      "border-radius:10px;\n"
                                      "font: 75 14pt \"MS Shell Dlg 2\";")
        self.pushButton.setObjectName("pushButton")
        self.labelImageData.raise_()
        self.lineEditFrom.raise_()
        self.labelTournament.raise_()
        self.comboBox.raise_()
        self.labelTitle.raise_()
        self.labelImageAtp.raise_()
        self.labelYear.raise_()
        self.labelFrom.raise_()
        self.labelTo.raise_()
        self.lineEditTo.raise_()
        self.pushButton.raise_()
        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "ATP matches prediction - ML algorithms"))
        self.labelTournament.setText(_translate("MainWindow", "Choose tournaments to include:"))
        self.comboBox.setItemText(0, _translate("MainWindow", "Atp All Matches"))
        self.comboBox.setItemText(1, _translate("MainWindow", "Grand Slams"))
        self.comboBox.setItemText(2, _translate("MainWindow", "Australian Open"))
        self.comboBox.setItemText(3, _translate("MainWindow", "US Open"))
        self.comboBox.setItemText(4, _translate("MainWindow", "Roland Garros"))
        self.comboBox.setItemText(5, _translate("MainWindow", "Wimbledon"))
        self.comboBox.setItemText(6, _translate("MainWindow", "Atp + Challengers"))
        self.labelTitle.setText(_translate("MainWindow", " Data processing"))
        self.labelYear.setText(_translate("MainWindow", "Input year range(between 2000 and 2021):"))
        self.labelFrom.setText(_translate("MainWindow", "From:"))
        self.labelTo.setText(_translate("MainWindow", "To:"))
        self.pushButton.setText(_translate("MainWindow", "Process data"))
        self.pushButton.clicked.connect(self.get_data)

    def get_data(self):
        yearFromString = self.lineEditFrom.text()
        yearToString = self.lineEditTo.text()

        yearFrom = 0
        if yearFromString.isnumeric():
            yearFrom = int(yearFromString)

        yearTo = 0
        if yearToString.isnumeric():
            yearTo = int(yearToString)

        onlyGrandSlams = False
        tourneyName = ""
        includeChallengers = False
        selectedDataSet = self.comboBox.currentIndex()
        if selectedDataSet == 1:
            onlyGrandSlams = True
        elif selectedDataSet == 6:
            includeChallengers = True
        elif selectedDataSet != 0:
            tourneyName = self.comboBox.currentText()

        if yearFrom < 2000 or yearFrom > 2021 or yearTo < 2000 or yearTo > 2021 or yearFrom > yearTo or yearFrom == yearTo:
            message = "Years are not in the correct format.\nPlease enter something between 2000 and 2021 and try again.\nAlso, yearFrom can not be same as yearTo as well as higher."
            self.openWarningDialog(message)
        else:
            data_processing = DataProcessing(absolute_path_to_data, yearFrom, yearTo, onlyGrandSlams, tourneyName,
                                             includeChallengers)
            data_processing.getCleanData()
            data_processing.dropColumns()
            data_processing.writeMatches()
            self.openFeatureEngineeringDialog(str(data_processing.matches.shape[0]))

    def openFeatureEngineeringDialog(self, numOfMatches):
        Dialog = QtWidgets.QDialog()
        ui = FeatureEngineeringDialog()
        ui.setupUi(Dialog, numOfMatches)
        Dialog.show()
        Dialog.exec_()

    def openWarningDialog(self, message):
        Dialog = QtWidgets.QDialog()
        ui = WarningDialog()
        ui.setupUi(Dialog, message)
        Dialog.show()
        Dialog.exec_()
